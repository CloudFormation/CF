{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Analyze CF",
    "Parameters": {
        "KeyPair": {
            "Type": "AWS::EC2::KeyPair::KeyName",
            "Description": "An Amazon EC2 key pair name."
        },
        "VpcStack": {
            "Description": "VPC Cloudformation Stack",
            "Type": "String",
            # @here Change VPC name
            "Default": "WinfVPC"
        }
    },
    "Resources": {
        "WinFrontierApplication": {
            "Type": "AWS::ElasticBeanstalk::Application",
            "Properties": {
                "Description": "AWS Elastic Beanstalk WinFrontier Application"
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "6728b688-5a0d-45a7-9d94-6e34ef27abd7"
                }
            }
        },
        "WinFrontierApplicationVersion": {
            "Type": "AWS::ElasticBeanstalk::ApplicationVersion",
            "Properties": {
                "ApplicationName": {
                    "Ref": "WinFrontierApplication"
                },
                "Description": "AWS ElasticBeanstalk WinFrontier Application Version",
                "SourceBundle": {
                  # @here Change bucketname
                    "S3Bucket": "lgbucketaws11",
                  # @here donwload zip file and upload to S3 bucket
                    "S3Key": "java-tomcat-v3.zip"
                }
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "0f3692bc-782d-4e0a-8bb8-da0e884cfa66"
                }
            }
        },
        "WinFrontierConfigurationTemplate": {
            "Type": "AWS::ElasticBeanstalk::ConfigurationTemplate",
            "Properties": {
                "ApplicationName": {
                    "Ref": "WinFrontierApplication"
                },
                "Description": "AWS ElasticBeanstalk WinFrontier Configuration Template",
                "OptionSettings": [
                    {
                        "Namespace": "aws:ec2:vpc",
                        "OptionName": "VPCId",
                        "Value": {
                            "Fn::ImportValue": {
                                "Fn::Sub": "${VpcStack}-VPC"
                            }
                        }
                    },
                    {
                        "Namespace": "aws:ec2:vpc",
                        "OptionName": "Subnets",
                        "Value": {
                            "Fn::ImportValue": {
                                "Fn::Sub": "${VpcStack}-ProtectSubnetID1"
                            }
                        }
                    },
                    {
                        "Namespace": "aws:ec2:vpc",
                        "OptionName": "ELBSubnets",
                        "Value": {
                            "Fn::ImportValue": {
                                "Fn::Sub": "${VpcStack}-PublicSubnetID1"
                            }
                        }
                    },
                    {
                        "Namespace": "aws:elasticbeanstalk:cloudwatch:logs",
                        "OptionName": "StreamLogs",
                        "Value": true
                    },
                    {
                        "Namespace": "aws:autoscaling:asg",
                        "OptionName": "MinSize",
                        "Value": "2"
                    },
                    {
                        "Namespace": "aws:autoscaling:asg",
                        "OptionName": "MaxSize",
                        "Value": "6"
                    },
                    {
                        "Namespace": "aws:elasticbeanstalk:environment",
                        "OptionName": "EnvironmentType",
                        "Value": "LoadBalanced"
                    },
                    {
                        "Namespace": "aws:autoscaling:launchconfiguration",
                        "OptionName": "EC2KeyName",
                        "Value": {
                            "Ref": "KeyPair"
                        }
                    },
                    {
                        "Namespace": "aws:autoscaling:launchconfiguration",
                        "OptionName": "InstanceType",
                        "Value": "t2.micro"
                    },
                    {
                        "Namespace": "aws:autoscaling:launchconfiguration",
                        "OptionName": "IamInstanceProfile",
                        "Value": "aws-elasticbeanstalk-ec2-role"
                    },
                    {
                        "Namespace": "aws:elasticbeanstalk:environment",
                        "OptionName": "ServiceRole",
                        "Value": "aws-elasticbeanstalk-service-role"
                    }
                ],
               # @here Change solution stack name here for different version
                "SolutionStackName": "64bit Amazon Linux 2017.09 v2.7.4 running Tomcat 8 Java 8"
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "e4cd96e5-fab3-4f31-ada2-7e9ca29a1323"
                }
            }
        },
        "WinFrontierEnvironment": {
            "Type": "AWS::ElasticBeanstalk::Environment",
            "Properties": {
                "ApplicationName": {
                    "Ref": "WinFrontierApplication"
                },
                "Description": "AWS ElasticBeanstalk WinFrontier Environment",
                "TemplateName": {
                    "Ref": "WinFrontierConfigurationTemplate"
                },
                "VersionLabel": {
                    "Ref": "WinFrontierApplicationVersion"
                }
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "014e0850-e2e9-488b-b7f3-6369e13bce08"
                }
            }
        }
    },
    "Metadata": {
        "AWS::CloudFormation::Designer": {
            "6728b688-5a0d-45a7-9d94-6e34ef27abd7": {
                "size": {
                    "width": 330,
                    "height": 330
                },
                "position": {
                    "x": 60,
                    "y": 50
                },
                "z": 1,
                "embeds": [
                    "e4cd96e5-fab3-4f31-ada2-7e9ca29a1323",
                    "0f3692bc-782d-4e0a-8bb8-da0e884cfa66",
                    "014e0850-e2e9-488b-b7f3-6369e13bce08"
                ]
            },
            "e4cd96e5-fab3-4f31-ada2-7e9ca29a1323": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 90,
                    "y": 110
                },
                "z": 2,
                "parent": "6728b688-5a0d-45a7-9d94-6e34ef27abd7",
                "embeds": [],
                "iscontainedinside": [
                    "6728b688-5a0d-45a7-9d94-6e34ef27abd7"
                ]
            },
            "0f3692bc-782d-4e0a-8bb8-da0e884cfa66": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 210,
                    "y": 110
                },
                "z": 2,
                "parent": "6728b688-5a0d-45a7-9d94-6e34ef27abd7",
                "embeds": [],
                "iscontainedinside": [
                    "6728b688-5a0d-45a7-9d94-6e34ef27abd7"
                ]
            },
            "014e0850-e2e9-488b-b7f3-6369e13bce08": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 90,
                    "y": 230
                },
                "z": 2,
                "parent": "6728b688-5a0d-45a7-9d94-6e34ef27abd7",
                "embeds": [],
                "isassociatedwith": [
                    "e4cd96e5-fab3-4f31-ada2-7e9ca29a1323"
                ],
                "iscontainedinside": [
                    "6728b688-5a0d-45a7-9d94-6e34ef27abd7"
                ]
            }
        }
    }
}
